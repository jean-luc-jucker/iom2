percent_digits = 0, percent_pattern = "{n}",
showNA = 'ifany', label = FALSE) %>% print(n=40)
crosstable(res, cols = c(BusinessSuccess),
by = c(InterviewType, Country, CountryOfReturn, Gender, AgeGroup,
Disabled, ReceivedSupportAs, BusinessType, BusinessMembers,
ReceivedIOMBusinessAdvice, BusinessHasEmployees, EmployeeNumber,
CoronaImpactOnBusiness, FirstChoice),
percent_digits = 0, percent_pattern = "{n}",
showNA = 'ifany', label = FALSE)
crosstable(res, cols = c(InterviewType, Country, CountryOfReturn, Gender, AgeGroup,
Disabled, ReceivedSupportAs, BusinessType, BusinessMembers,
ReceivedIOMBusinessAdvice, BusinessHasEmployees, EmployeeNumber,
CoronaImpactOnBusiness, FirstChoice),
by = c(BusinessSuccess),
percent_digits = 0, percent_pattern = "{n}",
showNA = 'ifany', label = FALSE) %>% print(n=40)
res %>% group_by(BusinessSuccess, InterviewType, Country, CountryOfReturn, Gender, AgeGroup,
Disabled, ReceivedSupportAs, BusinessType, BusinessMembers,
ReceivedIOMBusinessAdvice, BusinessHasEmployees, EmployeeNumber,
CoronaImpactOnBusiness, FirstChoice
) %>% summarise(Count = n()) %>% arrange(Count)
levels_count <- res %>% group_by(BusinessSuccess, InterviewType, Country, CountryOfReturn,
Gender, AgeGroup,
Disabled, ReceivedSupportAs, BusinessType, BusinessMembers,
ReceivedIOMBusinessAdvice, BusinessHasEmployees, EmployeeNumber,
CoronaImpactOnBusiness, FirstChoice
) %>% summarise(Count = n()) %>% arrange(Count)
levels_count
write_excel_csv(levels_count, 'data_clean/levels_count_model_1.csv')
levels_count %>% pivot_wider(names_from = BusinessSuccess)
levels_count %>% pivot_wider(names_from = BusinessSuccess)
levels_count %>% pivot_wider(names_from = BusinessSuccess, values_from = Count)
levels_count %>% pivot_wider(names_from = BusinessSuccess, values_from = Count)
levels_count %>% pivot_wider(names_from = BusinessSuccess, values_from = Count) %>% view()
getwd()
library(readxl)
library(tidyverse)
# Mimosa data (mimosa)
mimosa <- read_excel('data_raw/MIMOSA Reint Cases M&E-eco v2 identification.xlsx', # new data
na = c('N/A', 'NA', 'na', 'NULL'))
dim(mimosa) # 222,379 x 14
# Reintegration Economic Survey (kobo) ####
kobo <- read_excel('data_raw/RE_Economic_Survey_clean for data analysis.xlsx', # same data
na = c('N/A', 'NA', 'na'))
dim(kobo) # 2,073 x 154
# Check perfect duplicates
sum(duplicated(mimosa)) # 0
# Check duplicates in caseno
sum(duplicated(mimosa$caseno)) # 21,907 # expected (members of same family)
# Check duplicates in MemberNo
sum(duplicated(mimosa$MemberNo)) # 0 # expected (unique ID)
getwd()
library(readxl)
library(tidyverse)
# Mimosa data (mimosa)
mimosa <- read_excel('data_raw/MIMOSA Reint Cases M&E-eco v2 identification.xlsx', # new data
na = c('N/A', 'NA', 'na', 'NULL'))
dim(mimosa) # 222,379 x 14
# Reintegration Economic Survey (kobo) ####
kobo <- read_excel('data_raw/RE_Economic_Survey_clean for data analysis.xlsx', # same data
na = c('N/A', 'NA', 'na'))
dim(kobo) # 2,073 x 154
# Check perfect duplicates
sum(duplicated(mimosa)) # 0
# Check duplicates in caseno
sum(duplicated(mimosa$caseno)) # 21,907 # expected (members of same family)
# Check duplicates in MemberNo
sum(duplicated(mimosa$MemberNo)) # 0 # expected (unique ID)
# Following discussion with Client, we filter out respondents who are younger
# than 16 years old. This allows to resolve duplicates later.
#mimosa  <- mimosa %>% filter(AgeAtReferral_Mimosa > 15)
dim(mimosa) # 202,326
# Recheck duplicates in caseno
sum(duplicated(mimosa$caseno)) # 4,048 (big drop, as expected)
mimosa_slim <- mimosa %>% select(
# SELECT
caseno,
MemberNo,
`Niveau microbusiness`,
`Type de formation`,
`Duree formation`,
ArrivalDate_Mimosa,
`Date de reception de la reintegration`,
Gender_Mimosa,
AgeAtReferral_Mimosa
) %>%
# RENAME
rename(
"ID_1" =
caseno,
"ID_2" =
MemberNo
)
# Check perfect duplicates
sum(duplicated(kobo)) # 0
# Check duplicates in Identifiant MiMOSA du cas bis
sum(duplicated(kobo$`Identifiant MiMOSA du cas bis`)) # 137 (+1), corresponding to blanks
kobo_slim <- kobo %>% select(
# SELECT
`Identifiant MiMOSA du cas bis`,
# Metadata
"Date de l'enquête",
"Mode d'enquête",
# Dependent variables
"Comment se porte votre entreprise ou business actuellement ?",
"L’entreprise vous permet -elle de gagner assez d’argent pour subvenir à vos besoins et à celle de votre famille ?",
"Avez-vous déjà planifié de migrer de nouveau ?",
"Si vous n’aviez pas bénéficié de l’aide de l’OIM pour votre réintégration économique quelle serait votre situation actuelle ?",
"Pensez-vous que le retour a été une bonne décision ?",
"Êtes-vous satisfait de l’aide à la réintégration de manière globale ?",
# Grouping variables
"Pays",
"Pays d’où le migrant est de retour :",
"Sexe",
"Age (l'enquête est destinée aux personnes agées de 14 ans et plus)",
"Durée de l’absence du pays d’origine   Mettre 0 si moins d'un an",
"Situation de handicap",
"Par quel moyen avez-vous reçu cette assistance économique ?",
"Type de business bis",
"Qui sont les membres de cette entreprise ?",
"L'OIM   ou un de ses partenaires vous a-t-elle formé sur la façon de gérer une entreprise ?",
"L’entreprise emploie-t-elle du personnel ?",
"Si oui, combien des personnes sont employées par votre entreprise ?",
"Est-ce votre entreprise a été affectée par la maladie de Coronavirus ?",
"Est-ce que le type d'assistance économique que vous avez reçu correspondait à votre premier choix ?"
) %>%
# RENAME
rename("ID_1" =
`Identifiant MiMOSA du cas bis`
)
mimosa_slim # 202,326 x 9
kobo_slim # 2,073 x 23
mimosa_test <- mimosa_slim %>%
pivot_longer(c(ID_1, ID_2), values_to = "ID_1") %>%
select(-name) %>%
distinct_all()
result <- kobo_slim %>% left_join(mimosa_test)
result
dim(result) # 2,092, which is 2,092 - 2,073 = 19 more rows than in initial data!
colSums(is.na(result)) # ID_1 = 138, corresponding to blanks
sum(duplicated(result$ID_1)) # 156 (i.e., 156 - 138 blanks = our 18 rows (+1) from above)
to_resolve  <- result[duplicated(result$ID_1) | duplicated(result$ID_1, fromLast = TRUE), ]
to_resolve
write_csv(to_resolve, 'data_clean/to_resolve_v3.csv')
view(result)
getwd()
library(readxl)
library(tidyverse)
# Mimosa data (mimosa)
mimosa <- read_excel('data_raw/MIMOSA Reint Cases M&E-eco v2 identification.xlsx', # new data
na = c('N/A', 'NA', 'na', 'NULL'))
dim(mimosa) # 222,379 x 14
# Reintegration Economic Survey (kobo) ####
kobo <- read_excel('data_raw/RE_Economic_Survey_clean for data analysis.xlsx', # same data
na = c('N/A', 'NA', 'na'))
dim(kobo) # 2,073 x 154
# Check perfect duplicates
sum(duplicated(mimosa)) # 0
# Check duplicates in caseno
sum(duplicated(mimosa$caseno)) # 21,907 # expected (members of same family)
# Check duplicates in MemberNo
sum(duplicated(mimosa$MemberNo)) # 0 # expected (unique ID)
# Following discussion with Client, we filter out respondents who are younger
# than 16 years old. This allows to resolve duplicates later.
mimosa  <- mimosa %>% filter(AgeAtReferral_Mimosa > 15)
dim(mimosa) # 202,326
# Recheck duplicates in caseno
sum(duplicated(mimosa$caseno)) # 4,048 (big drop, as expected)
mimosa_slim <- mimosa %>% select(
# SELECT
caseno,
MemberNo,
`Niveau microbusiness`,
`Type de formation`,
`Duree formation`,
ArrivalDate_Mimosa,
`Date de reception de la reintegration`,
Gender_Mimosa,
AgeAtReferral_Mimosa
) %>%
# RENAME
rename(
"ID_1" =
caseno,
"ID_2" =
MemberNo
)
# Check perfect duplicates
sum(duplicated(kobo)) # 0
# Check duplicates in Identifiant MiMOSA du cas bis
sum(duplicated(kobo$`Identifiant MiMOSA du cas bis`)) # 137 (+1), corresponding to blanks
kobo_slim <- kobo %>% select(
# SELECT
`Identifiant MiMOSA du cas bis`,
# Metadata
"Date de l'enquête",
"Mode d'enquête",
# Dependent variables
"Comment se porte votre entreprise ou business actuellement ?",
"L’entreprise vous permet -elle de gagner assez d’argent pour subvenir à vos besoins et à celle de votre famille ?",
"Avez-vous déjà planifié de migrer de nouveau ?",
"Si vous n’aviez pas bénéficié de l’aide de l’OIM pour votre réintégration économique quelle serait votre situation actuelle ?",
"Pensez-vous que le retour a été une bonne décision ?",
"Êtes-vous satisfait de l’aide à la réintégration de manière globale ?",
# Grouping variables
"Pays",
"Pays d’où le migrant est de retour :",
"Sexe",
"Age (l'enquête est destinée aux personnes agées de 14 ans et plus)",
"Durée de l’absence du pays d’origine   Mettre 0 si moins d'un an",
"Situation de handicap",
"Par quel moyen avez-vous reçu cette assistance économique ?",
"Type de business bis",
"Qui sont les membres de cette entreprise ?",
"L'OIM   ou un de ses partenaires vous a-t-elle formé sur la façon de gérer une entreprise ?",
"L’entreprise emploie-t-elle du personnel ?",
"Si oui, combien des personnes sont employées par votre entreprise ?",
"Est-ce votre entreprise a été affectée par la maladie de Coronavirus ?",
"Est-ce que le type d'assistance économique que vous avez reçu correspondait à votre premier choix ?"
) %>%
# RENAME
rename("ID_1" =
`Identifiant MiMOSA du cas bis`
)
view(mimosa_slim)
getwd()
library(readxl)
library(tidyverse)
# Mimosa data (mimosa)
mimosa <- read_excel('data_raw/MIMOSA Reint Cases M&E-eco v2 identification.xlsx', # new data
na = c('N/A', 'NA', 'na', 'NULL'))
dim(mimosa) # 222,379 x 14
# Reintegration Economic Survey (kobo) ####
kobo <- read_excel('data_raw/RE_Economic_Survey_clean for data analysis.xlsx', # same data
na = c('N/A', 'NA', 'na'))
dim(kobo) # 2,073 x 154
# Check perfect duplicates
sum(duplicated(mimosa)) # 0
# Check duplicates in caseno
sum(duplicated(mimosa$caseno)) # 21,907 # expected (members of same family)
# Check duplicates in MemberNo
sum(duplicated(mimosa$MemberNo)) # 0 # expected (unique ID)
# Recheck duplicates in caseno
sum(duplicated(mimosa$caseno)) # 4,048 (big drop, as expected)
mimosa_slim <- mimosa %>% select(
# SELECT
caseno,
MemberNo,
`Niveau microbusiness`,
`Type de formation`,
`Duree formation`,
ArrivalDate_Mimosa,
`Date de reception de la reintegration`,
Gender_Mimosa,
AgeAtReferral_Mimosa
) %>%
# RENAME
rename(
"ID_1" =
caseno,
"ID_2" =
MemberNo
)
# Check perfect duplicates
sum(duplicated(kobo)) # 0
# Check duplicates in Identifiant MiMOSA du cas bis
sum(duplicated(kobo$`Identifiant MiMOSA du cas bis`)) # 137 (+1), corresponding to blanks
kobo_slim <- kobo %>% select(
# SELECT
`Identifiant MiMOSA du cas bis`,
# Metadata
"Date de l'enquête",
"Mode d'enquête",
# Dependent variables
"Comment se porte votre entreprise ou business actuellement ?",
"L’entreprise vous permet -elle de gagner assez d’argent pour subvenir à vos besoins et à celle de votre famille ?",
"Avez-vous déjà planifié de migrer de nouveau ?",
"Si vous n’aviez pas bénéficié de l’aide de l’OIM pour votre réintégration économique quelle serait votre situation actuelle ?",
"Pensez-vous que le retour a été une bonne décision ?",
"Êtes-vous satisfait de l’aide à la réintégration de manière globale ?",
# Grouping variables
"Pays",
"Pays d’où le migrant est de retour :",
"Sexe",
"Age (l'enquête est destinée aux personnes agées de 14 ans et plus)",
"Durée de l’absence du pays d’origine   Mettre 0 si moins d'un an",
"Situation de handicap",
"Par quel moyen avez-vous reçu cette assistance économique ?",
"Type de business bis",
"Qui sont les membres de cette entreprise ?",
"L'OIM   ou un de ses partenaires vous a-t-elle formé sur la façon de gérer une entreprise ?",
"L’entreprise emploie-t-elle du personnel ?",
"Si oui, combien des personnes sont employées par votre entreprise ?",
"Est-ce votre entreprise a été affectée par la maladie de Coronavirus ?",
"Est-ce que le type d'assistance économique que vous avez reçu correspondait à votre premier choix ?"
) %>%
# RENAME
rename("ID_1" =
`Identifiant MiMOSA du cas bis`
)
mimosa_slim # 202,326 x 9
view(mimosa_slim)
getwd()
library(readxl)
library(tidyverse)
# Mimosa data (mimosa)
mimosa <- read_excel('data_raw/MIMOSA Reint Cases M&E-eco v2 identification.xlsx', # new data
na = c('N/A', 'NA', 'na', 'NULL'))
dim(mimosa) # 222,379 x 14
# Reintegration Economic Survey (kobo) ####
kobo <- read_excel('data_raw/RE_Economic_Survey_clean for data analysis.xlsx', # same data
na = c('N/A', 'NA', 'na'))
dim(kobo) # 2,073 x 154
# Check perfect duplicates
sum(duplicated(mimosa)) # 0
# Check duplicates in caseno
sum(duplicated(mimosa$caseno)) # 21,907 # expected (members of same family)
# Check duplicates in MemberNo
sum(duplicated(mimosa$MemberNo)) # 0 # expected (unique ID)
# Recheck duplicates in caseno
sum(duplicated(mimosa$caseno)) # 4,048 (big drop, as expected)
mimosa %>% group_by(`Type de formation`) %>% summarise(count=n())
getwd()
library(readxl)
library(tidyverse)
# Mimosa data (mimosa)
mimosa <- read_excel('data_raw/MIMOSA Reint Cases M&E-eco v2 identification.xlsx', # new data
na = c('N/A', 'NA', 'na', 'NULL'))
dim(mimosa) # 222,379 x 14
mimosa %>% group_by(`Type de formation`) %>% summarise(count=n())
getwd()
library(readxl)
library(tidyverse)
# Mimosa data (mimosa)
mimosa <- read_excel('data_raw/MIMOSA Reint Cases M&E-eco v2 identification.xlsx', # new data
na = c('N/A', 'NA', 'na')) # removed 'NULL'
dim(mimosa) # 222,379 x 14
mimosa %>% group_by(`Type de formation`) %>% summarise(count=n())
# Check perfect duplicates
sum(duplicated(mimosa)) # 0
# Check duplicates in caseno
sum(duplicated(mimosa$caseno)) # 21,907 # expected (members of same family)
# Check duplicates in MemberNo
sum(duplicated(mimosa$MemberNo)) # 0 # expected (unique ID)
# Following discussion with Client, we filter out respondents who are younger
# than 16 years old. This allows to resolve duplicates later.
#mimosa  <- mimosa %>% filter(AgeAtReferral_Mimosa > 15)
dim(mimosa) # 202,326
# Recheck duplicates in caseno
sum(duplicated(mimosa$caseno)) # 4,048 (big drop, as expected)
mimosa_slim <- mimosa %>% select(
# SELECT
caseno,
MemberNo,
`Niveau microbusiness`,
`Type de formation`,
`Duree formation`,
ArrivalDate_Mimosa,
`Date de reception de la reintegration`,
Gender_Mimosa,
AgeAtReferral_Mimosa
) %>%
# RENAME
rename(
"ID_1" =
caseno,
"ID_2" =
MemberNo
)
mimosa %>% group_by(`Type de formation`) %>% summarise(count=n())
mimosa_slim %>% group_by(`Type de formation`) %>% summarise(count=n())
# Check perfect duplicates
sum(duplicated(kobo)) # 0
# Check duplicates in Identifiant MiMOSA du cas bis
sum(duplicated(kobo$`Identifiant MiMOSA du cas bis`)) # 137 (+1), corresponding to blanks
kobo_slim <- kobo %>% select(
# SELECT
`Identifiant MiMOSA du cas bis`,
# Metadata
"Date de l'enquête",
"Mode d'enquête",
# Dependent variables
"Comment se porte votre entreprise ou business actuellement ?",
"L’entreprise vous permet -elle de gagner assez d’argent pour subvenir à vos besoins et à celle de votre famille ?",
"Avez-vous déjà planifié de migrer de nouveau ?",
"Si vous n’aviez pas bénéficié de l’aide de l’OIM pour votre réintégration économique quelle serait votre situation actuelle ?",
"Pensez-vous que le retour a été une bonne décision ?",
"Êtes-vous satisfait de l’aide à la réintégration de manière globale ?",
# Grouping variables
"Pays",
"Pays d’où le migrant est de retour :",
"Sexe",
"Age (l'enquête est destinée aux personnes agées de 14 ans et plus)",
"Durée de l’absence du pays d’origine   Mettre 0 si moins d'un an",
"Situation de handicap",
"Par quel moyen avez-vous reçu cette assistance économique ?",
"Type de business bis",
"Qui sont les membres de cette entreprise ?",
"L'OIM   ou un de ses partenaires vous a-t-elle formé sur la façon de gérer une entreprise ?",
"L’entreprise emploie-t-elle du personnel ?",
"Si oui, combien des personnes sont employées par votre entreprise ?",
"Est-ce votre entreprise a été affectée par la maladie de Coronavirus ?",
"Est-ce que le type d'assistance économique que vous avez reçu correspondait à votre premier choix ?"
) %>%
# RENAME
rename("ID_1" =
`Identifiant MiMOSA du cas bis`
)
mimosa_slim # 202,326 x 9
kobo_slim # 2,073 x 23
# Main difference from v3: we now do the merge ourselves, using yet other data for mimosa
getwd()
library(readxl)
library(tidyverse)
# LOAD DATA ####
# Mimosa data (mimosa)
mimosa <- read_excel('data_raw/MIMOSA Reint Cases M&E-eco v2 identification.xlsx', # new data
na = c('N/A', 'NA', 'na')) # removed 'NULL'
dim(mimosa) # 222,379 x 14
# Reintegration Economic Survey (kobo) ####
kobo <- read_excel('data_raw/RE_Economic_Survey_clean for data analysis.xlsx', # same data
na = c('N/A', 'NA', 'na'))
dim(kobo) # 2,073 x 154
mimosa %>% group_by(`Type de formation`) %>% summarise(count=n())
# 1. MIMOSA ####
# Check perfect duplicates
sum(duplicated(mimosa)) # 0
# Check duplicates in caseno
sum(duplicated(mimosa$caseno)) # 21,907 # expected (members of same family)
# Check duplicates in MemberNo
sum(duplicated(mimosa$MemberNo)) # 0 # expected (unique ID)
# Following discussion with Client, we filter out respondents who are younger
# than 16 years old. This allows to resolve duplicates later.
#mimosa  <- mimosa %>% filter(AgeAtReferral_Mimosa > 15)
dim(mimosa) # 202,326
# Recheck duplicates in caseno
sum(duplicated(mimosa$caseno)) # 4,048 (big drop, as expected)
mimosa_slim <- mimosa %>% select(
# SELECT
caseno,
MemberNo,
`Niveau microbusiness`,
`Type de formation`,
`Duree formation`,
ArrivalDate_Mimosa,
`Date de reception de la reintegration`,
Gender_Mimosa,
AgeAtReferral_Mimosa
) %>%
# RENAME
rename(
"ID_1" =
caseno,
"ID_2" =
MemberNo
)
mimosa_slim %>% group_by(`Type de formation`) %>% summarise(count=n())
# 2. KOBO ####
# Check perfect duplicates
sum(duplicated(kobo)) # 0
# Check duplicates in Identifiant MiMOSA du cas bis
sum(duplicated(kobo$`Identifiant MiMOSA du cas bis`)) # 137 (+1), corresponding to blanks
kobo_slim <- kobo %>% select(
# SELECT
`Identifiant MiMOSA du cas bis`,
# Metadata
"Date de l'enquête",
"Mode d'enquête",
# Dependent variables
"Comment se porte votre entreprise ou business actuellement ?",
"L’entreprise vous permet -elle de gagner assez d’argent pour subvenir à vos besoins et à celle de votre famille ?",
"Avez-vous déjà planifié de migrer de nouveau ?",
"Si vous n’aviez pas bénéficié de l’aide de l’OIM pour votre réintégration économique quelle serait votre situation actuelle ?",
"Pensez-vous que le retour a été une bonne décision ?",
"Êtes-vous satisfait de l’aide à la réintégration de manière globale ?",
# Grouping variables
"Pays",
"Pays d’où le migrant est de retour :",
"Sexe",
"Age (l'enquête est destinée aux personnes agées de 14 ans et plus)",
"Durée de l’absence du pays d’origine   Mettre 0 si moins d'un an",
"Situation de handicap",
"Par quel moyen avez-vous reçu cette assistance économique ?",
"Type de business bis",
"Qui sont les membres de cette entreprise ?",
"L'OIM   ou un de ses partenaires vous a-t-elle formé sur la façon de gérer une entreprise ?",
"L’entreprise emploie-t-elle du personnel ?",
"Si oui, combien des personnes sont employées par votre entreprise ?",
"Est-ce votre entreprise a été affectée par la maladie de Coronavirus ?",
"Est-ce que le type d'assistance économique que vous avez reçu correspondait à votre premier choix ?"
) %>%
# RENAME
rename("ID_1" =
`Identifiant MiMOSA du cas bis`
)
mimosa_slim # 202,326 x 9
kobo_slim # 2,073 x 23
mimosa_test <- mimosa_slim %>%
pivot_longer(c(ID_1, ID_2), values_to = "ID_1") %>%
select(-name) %>%
distinct_all()
result <- kobo_slim %>% left_join(mimosa_test)
result
dim(result) # 2,092, which is 2,092 - 2,073 = 19 more rows than in initial data!
result %>% group_by(`Type de formation`) %>% summarise(count=n())
dim(result) # 2,092, which is 2,092 - 2,073 = 19 more rows than in initial data!
colSums(is.na(result)) # ID_1 = 138, corresponding to blanks
sum(duplicated(result$ID_1)) # 156 (i.e., 156 - 138 blanks = our 18 rows (+1) from above)
to_resolve  <- result[duplicated(result$ID_1) | duplicated(result$ID_1, fromLast = TRUE), ]
to_resolve
write_csv(to_resolve, 'data_clean/to_resolve_v3.csv')
write_excel_csv(to_resolve, 'data_clean/to_resolve_v3.csv')
